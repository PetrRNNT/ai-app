import{_ as rt}from"./_5kmRz0s.js";import{C as ut,D as B,E as F,g as dt,j as ct,c as u,a as e,b as A,w as pt,k as o,t as v,l as m,q as g,x as O,y as z,G as mt,v as S,s as M,F as P,r as R,p as $,z as gt,A as d,H as yt,o as i,d as ft,n as N,m as xt}from"./BAtAs9mt.js";import{C as vt}from"./BkNlCzdX.js";import{u as bt}from"./HdmTA0kg.js";import{u as ht}from"./BCkja1yl.js";import"./DlAUqK2U.js";import"./Bws3j-4N.js";const wt=ut("tag",{state:()=>({tags:[],loading:!1,error:null}),getters:{allTags:a=>a.tags},actions:{async fetchTags(){this.loading=!0,this.error=null;try{const a=B(),r=await $fetch("/api/tags",{headers:{Authorization:`Bearer ${a.token}`}});this.tags=r.data}catch(a){this.error=a.message||"Failed to fetch tags"}finally{this.loading=!1}},async createTag(a,r){this.loading=!0,this.error=null;try{const c=B(),p=await $fetch("/api/tags",{method:"POST",headers:{Authorization:`Bearer ${c.token}`,"Content-Type":"application/json"},body:{name:a,color:r}});return this.tags.push(p.data),p.data}catch(c){throw this.error=c.message||"Failed to create tag",c}finally{this.loading=!1}},async deleteTag(a){this.loading=!0,this.error=null;try{const r=B();await $fetch(`/api/tags/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${r.token}`}}),this.tags=this.tags.filter(c=>c.id!==a)}catch(r){throw this.error=r.message||"Failed to delete tag",r}finally{this.loading=!1}}}});function Tt(){const a=wt(),r=async()=>a.fetchTags(),c=async(b,y)=>a.createTag(b,y),p=async b=>a.deleteTag(b);return{tags:F(()=>a.tags),loading:F(()=>a.loading),error:F(()=>a.error),fetchTags:r,createTag:c,deleteTag:p}}const kt={class:"min-h-screen bg-gray-50"},Ct={class:"bg-white shadow-sm border-b"},_t={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Et={class:"flex justify-between items-center h-16"},Dt={class:"flex items-center space-x-4"},St={class:"flex items-center space-x-4"},Mt={key:0,class:"text-sm text-gray-600"},$t={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Lt={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},Bt={class:"lg:col-span-1"},Ft={class:"card"},Nt={class:"mb-4"},It={class:"mb-4"},Vt={class:"mb-4"},Ut={class:"flex items-center"},jt={class:"mb-4"},At={class:"card mt-4"},Ot={class:"lg:col-span-3"},zt={class:"card"},Pt={class:"flex justify-between items-center mb-4"},Rt={class:"text-lg font-semibold text-gray-900"},Ht={key:0,class:"text-center py-8"},Gt={key:1,class:"text-center py-8 text-gray-500"},Wt={key:2,class:"space-y-3"},qt={class:"flex items-start space-x-3 flex-1"},Qt=["checked","onChange"],Jt={class:"flex-1"},Kt={key:0,class:"text-sm text-gray-600 mt-1"},Xt={class:"flex items-center gap-2 mt-2"},Yt={key:0,class:"text-red-500 text-sm"},Zt={key:1,class:"text-gray-500 text-sm"},te=["onClick"],ee={class:"flex justify-end space-x-2"},se={class:"mb-4"},oe={class:"flex space-x-2"},ae=["onClick"],le={class:"flex justify-end space-x-2"},me=dt({__name:"index",setup(a){const{user:r,logout:c}=bt(),{filteredTasks:p,loading:b,fetchTasks:y,createTask:H,updateTask:G,deleteTask:W,setFilters:q,clearFilters:I}=ht(),{tags:Q,fetchTags:V,createTag:J}=Tt(),n=d({status:[],priority:[],important:!1,search:""}),k=d(""),C=d([]),h=d(!1),w=d(!1),_=d(!1),E=d(null),f=d(""),T=d(""),x=d(""),L=d("#3B82F6"),K=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#6B7280"];ct(async()=>{await Promise.all([y(),V()])});const D=()=>{const l={};n.value.status&&(l.status=[n.value.status]),n.value.priority&&(l.priority=[n.value.priority]),n.value.important&&(l.isImportant=!0),n.value.search&&(l.search=n.value.search),q(l)},X=()=>{clearTimeout(U),U=setTimeout(()=>{n.value.search=k.value,D()},300)};let U;const Y=l=>{const t=C.value.indexOf(l);t===-1?C.value.push(l):C.value.splice(t,1)},Z=async l=>{const t=l.status==="COMPLETED"?"NEW":"COMPLETED";await G({id:l.id,status:t}),await y()},tt=l=>{E.value=l,_.value=!0},et=async()=>{E.value&&(await W(E.value),E.value=null,_.value=!1,await y())},st=async()=>{f.value.trim()&&(await H({title:f.value,description:T.value,priority:"MEDIUM"}),f.value="",T.value="",h.value=!1,await y())},ot=async()=>{x.value.trim()&&(await J(x.value,L.value),await V(),x.value="",w.value=!1)},at=l=>new Date(l).toLocaleDateString("ru-RU",{day:"numeric",month:"short"}),lt=async()=>{await c()};return(l,t)=>{const nt=rt,it=yt("TagSelector");return i(),u("div",kt,[e("header",Ct,[e("div",_t,[e("div",Et,[e("div",Dt,[A(nt,{to:"/",class:"text-blue-600 hover:underline"},{default:pt(()=>[...t[17]||(t[17]=[ft("‚Üê –ù–∞–∑–∞–¥",-1)])]),_:1}),t[18]||(t[18]=e("h1",{class:"text-xl font-bold text-gray-900"},"–ó–∞–¥–∞—á–∏",-1))]),e("div",St,[o(r)?(i(),u("span",Mt,v(o(r).name),1)):m("",!0),e("button",{onClick:lt,class:"text-sm text-gray-600 hover:text-gray-900"}," –í—ã–π—Ç–∏ ")])])])]),e("main",$t,[e("div",Lt,[e("div",Bt,[e("div",Ft,[t[25]||(t[25]=e("h3",{class:"font-semibold text-gray-900 mb-4"},"–§–∏–ª—å—Ç—Ä—ã",-1)),e("div",Nt,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"–°—Ç–∞—Ç—É—Å",-1)),g(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o(n).status=s),class:"input-base text-sm",onChange:D},[...t[19]||(t[19]=[z('<option value="">–í—Å–µ</option><option value="NEW">–ù–æ–≤—ã–µ</option><option value="IN_PROGRESS">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</option><option value="COMPLETED">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option><option value="CANCELLED">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>',5)])],544),[[O,o(n).status]])]),e("div",It,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç",-1)),g(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(n).priority=s),class:"input-base text-sm",onChange:D},[...t[21]||(t[21]=[z('<option value="">–í—Å–µ</option><option value="CRITICAL">–ö—Ä–∏—Ç–∏—á–Ω—ã–π</option><option value="HIGH">–í—ã—Å–æ–∫–∏–π</option><option value="MEDIUM">–°—Ä–µ–¥–Ω–∏–π</option><option value="LOW">–ù–∏–∑–∫–∏–π</option>',5)])],544),[[O,o(n).priority]])]),e("div",Vt,[e("label",Ut,[g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o(n).important=s),type:"checkbox",class:"h-4 w-4 text-blue-600 rounded border-gray-300",onChange:D},null,544),[[mt,o(n).important]]),t[23]||(t[23]=e("span",{class:"ml-2 text-sm text-gray-700"},"–í–∞–∂–Ω—ã–µ",-1))])]),e("div",jt,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"–ü–æ–∏—Å–∫",-1)),g(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>M(k)?k.value=s:null),type:"text",class:"input-base text-sm",placeholder:"–ü–æ–∏—Å–∫ –∑–∞–¥–∞—á...",onInput:X},null,544),[[S,o(k)]])]),e("button",{onClick:t[4]||(t[4]=(...s)=>o(I)&&o(I)(...s)),class:"w-full btn-secondary text-sm"}," –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã ")]),e("div",At,[t[26]||(t[26]=e("h3",{class:"font-semibold text-gray-900 mb-4"},"–¢–µ–≥–∏",-1)),A(it,{tags:o(Q),"selected-tags":o(C),"show-count":"","allow-create":"",onSelect:Y,onCreate:t[5]||(t[5]=s=>w.value=!0)},null,8,["tags","selected-tags"])])]),e("div",Ot,[e("div",zt,[e("div",Pt,[e("h2",Rt," –ó–∞–¥–∞—á–∏ ("+v(o(p).length)+") ",1),e("button",{onClick:t[6]||(t[6]=s=>h.value=!0),class:"btn-primary"}," + –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞ ")]),o(b)?(i(),u("div",Ht,[...t[27]||(t[27]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):o(p).length===0?(i(),u("div",Gt," –ù–µ—Ç –∑–∞–¥–∞—á –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º ")):(i(),u("div",Wt,[(i(!0),u(P,null,R(o(p),s=>(i(),u("div",{key:s.id,class:"flex items-start justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[e("div",qt,[e("input",{type:"checkbox",checked:s.status==="COMPLETED",onChange:j=>Z(s),class:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-0.5"},null,40,Qt),e("div",Jt,[e("p",{class:N(["font-medium",s.status==="COMPLETED"?"line-through text-gray-400":"text-gray-900"])},v(s.title),3),s.description?(i(),u("p",Kt,v(s.description),1)):m("",!0),e("div",Xt,[e("span",{class:N(["px-2 py-0.5 text-xs rounded",s.priority==="HIGH"?"bg-red-100 text-red-800":s.priority==="MEDIUM"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},v(s.priority),3),s.isImportant?(i(),u("span",Yt,"üî¥ –í–∞–∂–Ω–æ–µ")):m("",!0),s.dueDate?(i(),u("span",Zt," üìÖ "+v(at(s.dueDate)),1)):m("",!0)])])]),e("button",{onClick:j=>tt(s.id),class:"text-gray-400 hover:text-red-600 p-2"}," üóëÔ∏è ",8,te)]))),128))]))])])])]),o(h)?(i(),u("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[11]||(t[11]=s=>h.value=!1)},[e("div",{class:"bg-white rounded-lg p-6 w-full max-w-md",onClick:t[10]||(t[10]=$(()=>{},["stop"]))},[t[29]||(t[29]=e("h3",{class:"text-lg font-semibold mb-4"},"–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞",-1)),e("form",{onSubmit:$(st,["prevent"])},[g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>M(f)?f.value=s:null),type:"text",placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",class:"input-base mb-4",autofocus:""},null,512),[[S,o(f)]]),g(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=s=>M(T)?T.value=s:null),placeholder:"–û–ø–∏—Å–∞–Ω–∏–µ",class:"input-base mb-4",rows:"3"},null,512),[[S,o(T)]]),e("div",ee,[e("button",{type:"button",onClick:t[9]||(t[9]=s=>h.value=!1),class:"btn-secondary"}," –û—Ç–º–µ–Ω–∞ "),t[28]||(t[28]=e("button",{type:"submit",class:"btn-primary"},"–°–æ–∑–¥–∞—Ç—å",-1))])],32)])])):m("",!0),o(w)?(i(),u("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[15]||(t[15]=s=>w.value=!1)},[e("div",{class:"bg-white rounded-lg p-6 w-full max-w-md",onClick:t[14]||(t[14]=$(()=>{},["stop"]))},[t[32]||(t[32]=e("h3",{class:"text-lg font-semibold mb-4"},"–ù–æ–≤—ã–π —Ç–µ–≥",-1)),e("form",{onSubmit:$(ot,["prevent"])},[g(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>M(x)?x.value=s:null),type:"text",placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–≥–∞",class:"input-base mb-4",autofocus:""},null,512),[[S,o(x)]]),e("div",se,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"–¶–≤–µ—Ç",-1)),e("div",oe,[(i(),u(P,null,R(K,s=>e("button",{key:s,type:"button",class:N(["w-8 h-8 rounded-full border-2",o(L)===s?"border-gray-900":"border-transparent"]),style:xt({backgroundColor:s}),onClick:j=>L.value=s},null,14,ae)),64))])]),e("div",le,[e("button",{type:"button",onClick:t[13]||(t[13]=s=>w.value=!1),class:"btn-secondary"}," –û—Ç–º–µ–Ω–∞ "),t[31]||(t[31]=e("button",{type:"submit",class:"btn-primary"},"–°–æ–∑–¥–∞—Ç—å",-1))])],32)])])):m("",!0),o(_)?(i(),gt(vt,{key:2,title:"–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É?",message:"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.",type:"danger","confirm-text":"–£–¥–∞–ª–∏—Ç—å","cancel-text":"–û—Ç–º–µ–Ω–∞",onConfirm:et,onCancel:t[16]||(t[16]=s=>_.value=!1)})):m("",!0)])}}});export{me as default};
