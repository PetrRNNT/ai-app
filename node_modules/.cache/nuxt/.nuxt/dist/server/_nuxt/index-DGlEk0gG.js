import { _ as __nuxt_component_0 } from "./nuxt-link-xjMrTn-4.js";
import { computed, defineComponent, ref, mergeProps, unref, useSSRContext, withCtx, createTextVNode } from "vue";
import { ssrRenderAttrs, ssrRenderList, ssrInterpolate, ssrRenderClass, ssrRenderAttr, ssrIncludeBooleanAttr, ssrLooseContain, ssrLooseEqual, ssrRenderComponent } from "vue/server-renderer";
import { defineStore } from "pinia";
import { b as useAuthStore } from "../server.mjs";
import "C:/Users/ipetr/Documents/todo-qwen-ai/todo-app/node_modules/nuxt/node_modules/hookable/dist/index.mjs";
import { u as useAuth } from "./useAuth-BbwPNOMF.js";
import "C:/Users/ipetr/Documents/todo-qwen-ai/todo-app/node_modules/ufo/dist/index.mjs";
import "C:/Users/ipetr/Documents/todo-qwen-ai/todo-app/node_modules/ofetch/dist/node.mjs";
import "#internal/nuxt/paths";
import "C:/Users/ipetr/Documents/todo-qwen-ai/todo-app/node_modules/unctx/dist/index.mjs";
import "C:/Users/ipetr/Documents/todo-qwen-ai/todo-app/node_modules/h3/dist/index.mjs";
import "C:/Users/ipetr/Documents/todo-qwen-ai/todo-app/node_modules/defu/dist/defu.mjs";
import "vue-router";
import "C:/Users/ipetr/Documents/todo-qwen-ai/todo-app/node_modules/klona/dist/index.mjs";
const useTemplateStore = defineStore("template", {
  state: () => ({
    templates: [],
    loading: false,
    error: null
  }),
  getters: {
    taskTemplates: (state) => state.templates.filter((t) => t.type === "TASK"),
    projectTemplates: (state) => state.templates.filter((t) => t.type === "PROJECT")
  },
  actions: {
    async fetchTemplates(type) {
      this.loading = true;
      this.error = null;
      try {
        const authStore = useAuthStore();
        const url = type ? `/api/templates?type=${type}` : "/api/templates";
        const data = await $fetch(url, {
          headers: { Authorization: `Bearer ${authStore.token}` }
        });
        this.templates = data.data;
      } catch (error) {
        this.error = error.message;
      } finally {
        this.loading = false;
      }
    },
    async createTemplate(data) {
      this.loading = true;
      this.error = null;
      try {
        const authStore = useAuthStore();
        const result = await $fetch("/api/templates", {
          method: "POST",
          headers: {
            Authorization: `Bearer ${authStore.token}`,
            "Content-Type": "application/json"
          },
          body: data
        });
        this.templates.push(result.data);
        return result.data;
      } catch (error) {
        this.error = error.message;
        throw error;
      } finally {
        this.loading = false;
      }
    },
    async deleteTemplate(id) {
      try {
        const authStore = useAuthStore();
        await $fetch(`/api/templates/${id}`, {
          method: "DELETE",
          headers: { Authorization: `Bearer ${authStore.token}` }
        });
        this.templates = this.templates.filter((t) => t.id !== id);
      } catch (error) {
        this.error = error.message;
        throw error;
      }
    }
  }
});
function useTemplate() {
  const templateStore = useTemplateStore();
  const fetchTemplates = async (type) => templateStore.fetchTemplates(type);
  const createTemplate = async (data) => templateStore.createTemplate(data);
  const deleteTemplate = async (id) => templateStore.deleteTemplate(id);
  return {
    templates: computed(() => templateStore.templates),
    taskTemplates: computed(() => templateStore.taskTemplates),
    projectTemplates: computed(() => templateStore.projectTemplates),
    loading: computed(() => templateStore.loading),
    error: computed(() => templateStore.error),
    fetchTemplates,
    createTemplate,
    deleteTemplate
  };
}
const _sfc_main$1 = /* @__PURE__ */ defineComponent({
  __name: "TemplateList",
  __ssrInlineRender: true,
  setup(__props) {
    const { templates, loading } = useTemplate();
    const showCreate = ref(false);
    const newTemplate = ref({
      name: "",
      type: "TASK",
      description: "",
      isPublic: false
    });
    return (_ctx, _push, _parent, _attrs) => {
      _push(`<div${ssrRenderAttrs(mergeProps({ class: "space-y-4" }, _attrs))}><div class="flex justify-between items-center"><h3 class="text-lg font-semibold text-gray-900">–®–∞–±–ª–æ–Ω—ã</h3><button class="btn-primary text-sm"> + –ù–æ–≤—ã–π —à–∞–±–ª–æ–Ω </button></div>`);
      if (unref(loading)) {
        _push(`<div class="text-center py-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div></div>`);
      } else if (unref(templates).length === 0) {
        _push(`<div class="text-center py-8 text-gray-500"> –ù–µ—Ç —à–∞–±–ª–æ–Ω–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —à–∞–±–ª–æ–Ω! </div>`);
      } else {
        _push(`<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><!--[-->`);
        ssrRenderList(unref(templates), (template) => {
          _push(`<div class="card hover:shadow-md transition-shadow cursor-pointer"><div class="flex items-start justify-between mb-2"><h4 class="font-semibold text-gray-900">${ssrInterpolate(template.name)}</h4><button class="text-gray-400 hover:text-red-600"> üóëÔ∏è </button></div><div class="flex items-center gap-2 text-sm"><span class="${ssrRenderClass([
            "px-2 py-0.5 rounded text-xs",
            template.type === "TASK" ? "bg-blue-100 text-blue-800" : "bg-green-100 text-green-800"
          ])}">${ssrInterpolate(template.type === "TASK" ? "–ó–∞–¥–∞—á–∞" : "–ü—Ä–æ–µ–∫—Ç")}</span>`);
          if (template.isPublic) {
            _push(`<span class="text-green-600 text-xs">üåç –ü—É–±–ª–∏—á–Ω—ã–π</span>`);
          } else {
            _push(`<!---->`);
          }
          _push(`</div></div>`);
        });
        _push(`<!--]--></div>`);
      }
      if (unref(showCreate)) {
        _push(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg p-6 w-full max-w-md"><h3 class="text-lg font-semibold mb-4">–ù–æ–≤—ã–π —à–∞–±–ª–æ–Ω</h3><form><input${ssrRenderAttr("value", unref(newTemplate).name)} type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" class="input-base mb-4" required><select class="input-base mb-4"><option value="TASK"${ssrIncludeBooleanAttr(Array.isArray(unref(newTemplate).type) ? ssrLooseContain(unref(newTemplate).type, "TASK") : ssrLooseEqual(unref(newTemplate).type, "TASK")) ? " selected" : ""}>–®–∞–±–ª–æ–Ω –∑–∞–¥–∞—á–∏</option><option value="PROJECT"${ssrIncludeBooleanAttr(Array.isArray(unref(newTemplate).type) ? ssrLooseContain(unref(newTemplate).type, "PROJECT") : ssrLooseEqual(unref(newTemplate).type, "PROJECT")) ? " selected" : ""}>–®–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∞</option></select><textarea placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" class="input-base mb-4" rows="3">${ssrInterpolate(unref(newTemplate).description)}</textarea><label class="flex items-center gap-2 mb-4"><input${ssrIncludeBooleanAttr(Array.isArray(unref(newTemplate).isPublic) ? ssrLooseContain(unref(newTemplate).isPublic, null) : unref(newTemplate).isPublic) ? " checked" : ""} type="checkbox" class="rounded"><span class="text-sm text-gray-700">–ü—É–±–ª–∏—á–Ω—ã–π —à–∞–±–ª–æ–Ω</span></label><div class="flex justify-end gap-2"><button type="button" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button><button type="submit" class="btn-primary">–°–æ–∑–¥–∞—Ç—å</button></div></form></div></div>`);
      } else {
        _push(`<!---->`);
      }
      _push(`</div>`);
    };
  }
});
const _sfc_setup$1 = _sfc_main$1.setup;
_sfc_main$1.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("components/template/TemplateList.vue");
  return _sfc_setup$1 ? _sfc_setup$1(props, ctx) : void 0;
};
const __nuxt_component_1 = Object.assign(_sfc_main$1, { __name: "TemplateList" });
const _sfc_main = /* @__PURE__ */ defineComponent({
  __name: "index",
  __ssrInlineRender: true,
  setup(__props) {
    const { user } = useAuth();
    return (_ctx, _push, _parent, _attrs) => {
      const _component_NuxtLink = __nuxt_component_0;
      const _component_TemplateList = __nuxt_component_1;
      _push(`<div${ssrRenderAttrs(mergeProps({ class: "min-h-screen bg-gray-50" }, _attrs))}><header class="bg-white shadow-sm border-b"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center h-16"><div class="flex items-center space-x-4">`);
      _push(ssrRenderComponent(_component_NuxtLink, {
        to: "/",
        class: "text-blue-600 hover:underline"
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`‚Üê –ù–∞–∑–∞–¥`);
          } else {
            return [
              createTextVNode("‚Üê –ù–∞–∑–∞–¥")
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(`<h1 class="text-xl font-bold text-gray-900">–®–∞–±–ª–æ–Ω—ã</h1></div><div class="flex items-center space-x-4">`);
      if (unref(user)) {
        _push(`<span class="text-sm text-gray-600">${ssrInterpolate(unref(user).name)}</span>`);
      } else {
        _push(`<!---->`);
      }
      _push(`<button class="text-sm text-gray-600 hover:text-gray-900"> –í—ã–π—Ç–∏ </button></div></div></div></header><main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">`);
      _push(ssrRenderComponent(_component_TemplateList, null, null, _parent));
      _push(`</main></div>`);
    };
  }
});
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("pages/templates/index.vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};
export {
  _sfc_main as default
};
//# sourceMappingURL=index-DGlEk0gG.js.map
