import{_ as J}from"./_5kmRz0s.js";import{g as B,c as n,a as t,F as D,r as P,o as s,m as K,t as c,l as y,p as S,n as f,j as Q,b as N,w as X,k as l,z as Y,q as I,v as H,s as O,x as Z,y as tt,A as m,d as et,D as st}from"./BAtAs9mt.js";import{_ as ot}from"./DU1C0ixR.js";import{u as nt}from"./HdmTA0kg.js";import{u as at}from"./D1QnkK4h.js";import{u as lt}from"./BCkja1yl.js";import"./Bws3j-4N.js";const it={class:"space-y-4"},rt={class:"flex justify-between items-center"},ct={key:0,class:"text-center py-8"},dt={key:1,class:"text-center py-8 text-gray-500"},ut={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},pt=["onClick"],yt={class:"p-4"},mt={class:"flex items-start justify-between mb-3"},xt={class:"flex items-center gap-2 flex-1"},gt={key:0,class:"text-xl"},vt={class:"font-semibold text-gray-900 line-clamp-2"},_t=["onClick"],bt={key:0,class:"text-sm text-gray-600 mb-3 line-clamp-3"},ft={class:"flex items-center justify-between text-sm"},ht={class:"flex items-center gap-1 text-gray-500"},wt=["title"],kt={key:1,class:"mt-3 pt-3 border-t text-xs text-gray-500"},Ct={key:0,class:"flex items-center gap-1"},$t={key:1,class:"flex items-center gap-1"},Et=B({__name:"ProjectList",props:{projects:{},loading:{type:Boolean}},emits:["create","select","edit"],setup(h,{emit:w}){const T=w,M=u=>{T("select",u)},k=u=>({ACTIVE:"–ê–∫—Ç–∏–≤–Ω—ã–π",ARCHIVED:"–ê—Ä—Ö–∏–≤",COMPLETED:"–ó–∞–≤–µ—Ä—à–µ–Ω",ON_HOLD:"–ù–∞ –ø–∞—É–∑–µ"})[u]||u,g=u=>u?new Date(u).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"}):"";return(u,r)=>(s(),n("div",it,[t("div",rt,[r[1]||(r[1]=t("h2",{class:"text-lg font-semibold text-gray-900"},"–ü—Ä–æ–µ–∫—Ç—ã",-1)),t("button",{onClick:r[0]||(r[0]=a=>u.$emit("create")),class:"btn-primary text-sm"}," + –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç ")]),h.loading?(s(),n("div",ct,[...r[2]||(r[2]=[t("div",{class:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1)])])):h.projects.length===0?(s(),n("div",dt," –ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç! ")):(s(),n("div",ut,[(s(!0),n(D,null,P(h.projects,a=>(s(),n("div",{key:a.id,class:"card hover:shadow-lg transition-shadow cursor-pointer overflow-hidden",onClick:L=>M(a)},[t("div",{class:"h-2 w-full",style:K({backgroundColor:a.color||"#3B82F6"})},null,4),t("div",yt,[t("div",mt,[t("div",xt,[a.icon?(s(),n("div",gt,c(a.icon),1)):y("",!0),t("h3",vt,c(a.name),1)]),t("button",{onClick:S(L=>u.$emit("edit",a),["stop"]),class:"text-gray-400 hover:text-gray-600 flex-shrink-0 ml-2",title:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"}," ‚úèÔ∏è ",8,_t)]),a.description?(s(),n("p",bt,c(a.description),1)):y("",!0),t("div",ft,[t("div",ht,[r[3]||(r[3]=t("span",null,"üìÅ",-1)),t("span",null,c(a._count?.tasks||0)+" –∑–∞–¥–∞—á",1)]),t("span",{class:f(["px-2 py-1 rounded-full text-xs font-medium",a.status==="ACTIVE"?"bg-green-100 text-green-800":a.status==="ARCHIVED"?"bg-gray-100 text-gray-800":a.status==="COMPLETED"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"]),title:k(a.status)},c(k(a.status)),11,wt)]),a.startDate||a.endDate?(s(),n("div",kt,[a.startDate?(s(),n("div",Ct,[r[4]||(r[4]=t("span",null,"üìÖ",-1)),t("span",null,"–ù–∞—á–∞–ª–æ: "+c(g(a.startDate)),1)])):y("",!0),a.endDate?(s(),n("div",$t,[r[5]||(r[5]=t("span",null,"üèÅ",-1)),t("span",null,"–ö–æ–Ω–µ—Ü: "+c(g(a.endDate)),1)])):y("",!0)])):y("",!0)])],8,pt))),128))]))]))}}),Dt=Object.assign(Et,{__name:"ProjectList"}),Pt={class:"min-h-screen bg-gray-50"},Tt={class:"bg-white shadow-sm border-b"},Mt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Lt={class:"flex justify-between items-center h-16"},jt={class:"flex items-center space-x-4"},It={class:"flex items-center space-x-4"},Ot={key:0,class:"text-sm text-gray-600"},St={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Vt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},At={class:"lg:col-span-1"},Nt={class:"lg:col-span-2"},Ht={key:0,class:"card"},Bt={class:"flex items-start justify-between mb-6"},Ft={class:"text-2xl font-bold text-gray-900"},Ut={key:0,class:"text-gray-600 mt-1"},zt={key:0,class:"space-y-6"},Rt={class:"font-semibold text-gray-700 mb-3"},Gt={class:"space-y-2"},Wt={class:"flex items-center space-x-3"},qt=["checked","onChange"],Jt={key:1,class:"border-t pt-4"},Kt={class:"space-y-2"},Qt={class:"flex items-center space-x-3"},Xt=["checked","onChange"],Yt={key:2,class:"text-center py-8 text-gray-500"},Zt={key:1,class:"card text-center py-12 text-gray-500"},te={class:"flex justify-end space-x-2"},ce=B({__name:"[id]",setup(h){const{user:w,logout:T}=nt(),{projects:M,loading:k,fetchProjects:g,createProject:u,updateProject:r}=at(),{createTask:a,updateTask:L}=lt(),i=m(null),C=m(!1),$=m(null),v=m(!1),x=m(""),_=m(""),E=m("MEDIUM");Q(async()=>{await g()});const F=async d=>{try{i.value=await j(d.id)}catch(e){console.error("Failed to load project:",e),i.value=d}},j=async d=>{const e=st();try{return(await $fetch(`/api/projects/${d}`,{headers:{Authorization:`Bearer ${e.token}`}})).data}catch(b){throw console.error("Error fetching project:",b),b}},U=d=>{$.value=d,C.value=!0},V=()=>{C.value=!1,$.value=null},z=async d=>{d.id?await r(d):await u(d),await g(),V()},R=async()=>{!x.value.trim()||!i.value||(await a({title:x.value,description:_.value,priority:E.value,projectId:i.value.id}),x.value="",_.value="",v.value=!1,i.value=await j(i.value.id))},A=async d=>{const e=d.status==="COMPLETED"?"NEW":"COMPLETED";await L({id:d.id,status:e}),i.value=await j(i.value.id)},G=async()=>{await T()};return(d,e)=>{const b=J,W=Dt,q=ot;return s(),n("div",Pt,[t("header",Tt,[t("div",Mt,[t("div",Lt,[t("div",jt,[N(b,{to:"/",class:"text-blue-600 hover:underline"},{default:X(()=>[...e[8]||(e[8]=[et("‚Üê –ù–∞–∑–∞–¥",-1)])]),_:1}),e[9]||(e[9]=t("h1",{class:"text-xl font-bold text-gray-900"},"–ü—Ä–æ–µ–∫—Ç—ã",-1))]),t("div",It,[l(w)?(s(),n("span",Ot,c(l(w).name),1)):y("",!0),t("button",{onClick:G,class:"text-sm text-gray-600 hover:text-gray-900"}," –í—ã–π—Ç–∏ ")])])])]),t("main",St,[t("div",Vt,[t("div",At,[N(W,{projects:l(M),loading:l(k),onCreate:e[0]||(e[0]=o=>C.value=!0),onSelect:F,onEdit:U},null,8,["projects","loading"])]),t("div",Nt,[l(i)?(s(),n("div",Ht,[t("div",Bt,[t("div",null,[t("h2",Ft,c(l(i).name),1),l(i).description?(s(),n("p",Ut,c(l(i).description),1)):y("",!0)]),t("button",{onClick:e[1]||(e[1]=o=>v.value=!0),class:"btn-primary"}," + –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞ ")]),l(i).sections?.length?(s(),n("div",zt,[(s(!0),n(D,null,P(l(i).sections,o=>(s(),n("div",{key:o.id,class:"border-t pt-4"},[t("h3",Rt,c(o.name),1),t("div",Gt,[(s(!0),n(D,null,P(l(i).tasks?.filter(p=>p.sectionId===o.id),p=>(s(),n("div",{key:p.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded hover:bg-gray-100"},[t("div",Wt,[t("input",{type:"checkbox",checked:p.status==="COMPLETED",onChange:ee=>A(p),class:"h-4 w-4 rounded border-gray-300 text-blue-600"},null,40,qt),t("span",{class:f({"line-through text-gray-400":p.status==="COMPLETED"})},c(p.title),3)]),t("span",{class:f(["px-2 py-1 text-xs rounded",p.priority==="HIGH"?"bg-red-100 text-red-800":p.priority==="MEDIUM"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},c(p.priority),3)]))),128))])]))),128))])):y("",!0),l(i).tasks?.filter(o=>!o.sectionId).length?(s(),n("div",Jt,[e[10]||(e[10]=t("h3",{class:"font-semibold text-gray-700 mb-3"},"–ë–µ–∑ —Ä–∞–∑–¥–µ–ª–∞",-1)),t("div",Kt,[(s(!0),n(D,null,P(l(i).tasks?.filter(o=>!o.sectionId),o=>(s(),n("div",{key:o.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded hover:bg-gray-100"},[t("div",Qt,[t("input",{type:"checkbox",checked:o.status==="COMPLETED",onChange:p=>A(o),class:"h-4 w-4 rounded border-gray-300 text-blue-600"},null,40,Xt),t("span",{class:f({"line-through text-gray-400":o.status==="COMPLETED"})},c(o.title),3)]),t("span",{class:f(["px-2 py-1 text-xs rounded",o.priority==="HIGH"?"bg-red-100 text-red-800":o.priority==="MEDIUM"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},c(o.priority),3)]))),128))])])):l(i).tasks?.length?y("",!0):(s(),n("div",Yt," –í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á "))])):(s(),n("div",Zt," –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–¥–∞—á "))])])]),l(C)||l($)?(s(),Y(q,{key:0,project:l($),onClose:V,onSave:z},null,8,["project"])):y("",!0),l(v)?(s(),n("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[7]||(e[7]=o=>v.value=!1)},[t("div",{class:"bg-white rounded-lg p-6 w-full max-w-md",onClick:e[6]||(e[6]=S(()=>{},["stop"]))},[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold mb-4"},"–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞",-1)),t("form",{onSubmit:S(R,["prevent"])},[I(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>O(x)?x.value=o:null),type:"text",placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",class:"input-base mb-4",autofocus:""},null,512),[[H,l(x)]]),I(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>O(_)?_.value=o:null),placeholder:"–û–ø–∏—Å–∞–Ω–∏–µ",class:"input-base mb-4",rows:"3"},null,512),[[H,l(_)]]),I(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>O(E)?E.value=o:null),class:"input-base mb-4"},[...e[11]||(e[11]=[tt('<option value="NONE">–ë–µ–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞</option><option value="LOW">–ù–∏–∑–∫–∏–π</option><option value="MEDIUM">–°—Ä–µ–¥–Ω–∏–π</option><option value="HIGH">–í—ã—Å–æ–∫–∏–π</option><option value="CRITICAL">–ö—Ä–∏—Ç–∏—á–Ω—ã–π</option>',5)])],512),[[Z,l(E)]]),t("div",te,[t("button",{type:"button",onClick:e[5]||(e[5]=o=>v.value=!1),class:"btn-secondary"}," –û—Ç–º–µ–Ω–∞ "),e[12]||(e[12]=t("button",{type:"submit",class:"btn-primary"},"–°–æ–∑–¥–∞—Ç—å",-1))])],32)])])):y("",!0)])}}});export{ce as default};
