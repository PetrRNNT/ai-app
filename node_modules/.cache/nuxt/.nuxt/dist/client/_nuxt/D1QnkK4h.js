import{C as d,D as s,E as c}from"./BAtAs9mt.js";const l=d("project",{state:()=>({projects:[],currentProject:null,loading:!1,error:null}),getters:{allProjects:t=>t.projects,activeProjects:t=>t.projects.filter(e=>e.status==="ACTIVE"),archivedProjects:t=>t.projects.filter(e=>e.status==="ARCHIVED")},actions:{async fetchProjects(){this.loading=!0,this.error=null;try{const e=s().validToken;if(!e)throw new Error("Not authenticated");const r=await $fetch("/api/projects",{headers:{Authorization:`Bearer ${e}`}});this.projects=r.data}catch(t){this.error=t.message||"Failed to fetch projects"}finally{this.loading=!1}},async fetchProjectById(t){this.loading=!0,this.error=null;try{const r=s().validToken;if(!r)throw new Error("Not authenticated");const o=await $fetch(`/api/projects/${t}`,{headers:{Authorization:`Bearer ${r}`}});return this.currentProject=o.data,o.data}catch(e){throw this.error=e.message||"Failed to fetch project",e}finally{this.loading=!1}},async createProject(t){this.loading=!0,this.error=null;try{const r=s().validToken;if(!r)throw new Error("Not authenticated");const o=await $fetch("/api/projects",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:t});return this.projects.push(o.data),o.data}catch(e){throw this.error=e.message||"Failed to create project",e}finally{this.loading=!1}},async updateProject(t){this.loading=!0,this.error=null;try{const r=s().validToken;if(!r)throw new Error("Not authenticated");const{id:o,...i}=t,a=await $fetch(`/api/projects/${o}`,{method:"PUT",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:i}),n=this.projects.findIndex(h=>h.id===o);return n!==-1&&(this.projects[n]=a.data),this.currentProject?.id===o&&(this.currentProject=a.data),a.data}catch(e){throw this.error=e.message||"Failed to update project",e}finally{this.loading=!1}},async deleteProject(t){this.loading=!0,this.error=null;try{const r=s().validToken;if(!r)throw new Error("Not authenticated");await $fetch(`/api/projects/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}}),this.projects=this.projects.filter(o=>o.id!==t)}catch(e){throw this.error=e.message||"Failed to delete project",e}finally{this.loading=!1}}}});function j(){const t=l(),e=async()=>t.fetchProjects(),r=async a=>t.createProject(a),o=async a=>t.updateProject(a),i=async a=>t.deleteProject(a);return{projects:c(()=>t.projects),activeProjects:c(()=>t.activeProjects),archivedProjects:c(()=>t.archivedProjects),currentProject:c(()=>t.currentProject),loading:c(()=>t.loading),error:c(()=>t.error),fetchProjects:e,createProject:r,updateProject:o,deleteProject:i}}export{j as u};
